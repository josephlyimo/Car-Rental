<style>
  input{
    border-color: 1px solid #2563eb;
  }
</style>
<div class="form-container">
  <h2>{{#if product}}Edit{{else}}Add New{{/if}} Product</h2>

  <form action="{{#if product}}/admin/products/edit/{{product.id}}{{else}}/admin/products/new{{/if}}" method="POST" enctype="multipart/form-data" class="product-form">
    <div class="form-group">
      <label for="name">Name:</label>
      <input type="text" id="name" name="name" value="{{#if product}}{{product.name}}{{/if}}" required />
    </div>

    <div class="form-group">
      <label for="type">Type:</label>
      <select id="type" name="type" required>
        <option value="">Select type</option>
        <option value="tour" {{#if product}}{{#if (eq product.type "tour")}}selected{{/if}}{{/if}}>tour</option>
        <option value="ceremony" {{#if product}}{{#if (eq product.type "ceremony")}}selected{{/if}}{{/if}}>ceremony</option>
        <option value="private" {{#if product}}{{#if (eq product.type "private")}}selected{{/if}}{{/if}}>private</option>
      </select>
    </div>

    <div class="form-group">
      <label for="color">Color:</label>
      <input type="text" id="color" name="color" value="{{#if product}}{{product.color}}{{/if}}" required />
    </div>

    <div class="form-group" style="display:none;">
      <label for="status">Status:</label>
      <select id="status" name="status" required>
        <option value="available" selected>Available</option>
        <option value="booked">Booked</option>
        <option value="not-available">Not Available</option>
      </select>
    </div>

    <div class="form-group">
      <label for="description">Description:</label>
      <input type="text" id="description" name="description" value="{{#if product}}{{product.description}}{{/if}}" />
    </div>

    <div class="form-group">
      <label for="image">Image:</label>
      <input type="file" id="image" name="image" accept="image/*" onchange="previewImage(event)" />
      {{#if product}}
        {{#if product.images.length}}
          <img src="{{product.images.[0]}}" alt="{{product.name}}" class="product-image-preview" id="imagePreview" />
        {{else}}
          <img src="" alt="Image Preview" class="product-image-preview" id="imagePreview" style="display:none;" />
        {{/if}}
      {{else}}
        <img src="" alt="Image Preview" class="product-image-preview" id="imagePreview" style="display:none;" />
      {{/if}}
    </div>

    <div class="form-group">
      <label for="price">Price:</label>
      <input type="number" id="price" name="price" value="{{#if product}}{{product.price}}{{/if}}" required />
    </div>

    <div class="form-group">
      <label for="base_rental_duration">Base Rental Duration (days):</label>
      <input type="number" id="base_rental_duration" name="base_rental_duration" value="3" readonly />
    </div>

    <button type="submit" class="btn btn-primary">{{#if product}}Update{{else}}Add{{/if}} Product</button>
  </form>
</div>

<script>
  function previewImage(event) {
    const input = event.target;
    const preview = document.getElementById('imagePreview');
    if (input.files && input.files[0]) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.src = e.target.result;
        preview.style.display = 'block';
      }
      reader.readAsDataURL(input.files[0]);
    } else {
      preview.src = '';
      preview.style.display = 'none';
    }
  }
</script>
